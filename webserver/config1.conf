# ============================================================================
# WEBSERVER CONFIGURATION FILE (Simplified)
# ============================================================================

server {
    listen 8080                    # Port the server listens on
    server_name webservers         # Identified by 'Host: webservers' header
    
    # Custom error mappings
    error_page 404 /404.html
    error_page 500 /500.html
    error_page 502 /502.html
    error_page 503 /503.html
    error_page 504 /504.html
    
    client_max_body_size 10M       # Rejects any POST larger than 10MB

    # Main root location
    location / {
        allow_methods GET
        root /var/srv_webservers/www/
        autoindex off
        index index.html
    }

    # Upload directory
    location /upload {
        allow_methods GET POST      # Added GET so you can see the directory if needed
        root /var/srv_webservers/uploads
        autoindex on                # Turned on so you can verify uploads
    }

    # Submission endpoint
    location /submit {
        allow_methods POST
        root /var/srv_webservers/submit
        autoindex off
    }

    # Redirection example
    location /redir {
        allow_methods GET
        # Removed the semicolon to prevent parsing errors in C++
        return 301 /error/redirection.html
        root /var/srv_webservers/www
    }
}